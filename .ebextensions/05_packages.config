packages:
  yum:
    gcc: []
    gcc-c++: []
    python3-devel: []
    sqlite-devel: []
    libffi-devel: []
    openssl-devel: []
    
container_commands:
  01_update_pip:
    command: |
      #!/bin/bash
      if [ -d /var/app/venv/staging-* ]; then
        source /var/app/venv/staging-*/bin/activate
      else
        source /var/app/venv/*/bin/activate
      fi
      pip install --upgrade pip setuptools wheel
    leader_only: false
    
  02_install_numpy:
    command: |
      #!/bin/bash
      if [ -d /var/app/venv/staging-* ]; then
        source /var/app/venv/staging-*/bin/activate
      else
        source /var/app/venv/*/bin/activate
      fi
      pip install numpy==1.24.3 --no-cache-dir
    leader_only: false
    
  03_install_chromadb_deps:
    command: |
      #!/bin/bash
      if [ -d /var/app/venv/staging-* ]; then
        source /var/app/venv/staging-*/bin/activate
      else
        source /var/app/venv/*/bin/activate
      fi
      pip install pydantic typing-extensions --no-cache-dir
    leader_only: false
    
  04_install_chromadb:
    command: |
      #!/bin/bash
      if [ -d /var/app/venv/staging-* ]; then
        source /var/app/venv/staging-*/bin/activate
      else
        source /var/app/venv/*/bin/activate
      fi
      pip install chromadb==0.4.22 --no-cache-dir --no-deps
      pip install chromadb==0.4.22 --no-cache-dir
    leader_only: false
    
  05_install_langchain:
    command: |
      #!/bin/bash
      if [ -d /var/app/venv/staging-* ]; then
        source /var/app/venv/staging-*/bin/activate
      else
        source /var/app/venv/*/bin/activate
      fi
      pip install langchain==0.1.0 langchain-openai==0.0.5 langchain-community==0.0.10 --no-cache-dir
    leader_only: false 